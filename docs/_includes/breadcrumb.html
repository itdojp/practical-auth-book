<!-- Breadcrumb Navigation -->
<ol class="breadcrumb-list" vocab="https://schema.org/" typeof="BreadcrumbList">
    <!-- Home -->
    <li property="itemListElement" typeof="ListItem">
        <a property="item" typeof="WebPage" href="{{ '/' | relative_url }}">
            <span property="name">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="breadcrumb-home-icon">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9,22 9,12 15,12 15,22"></polyline>
                </svg>
                ホーム
            </span>
        </a>
        <meta property="position" content="1">
    </li>
    
    <!-- Section (Introduction/Chapters/Appendices) -->
    {% if page.url contains '/introduction/' %}
        <li property="itemListElement" typeof="ListItem">
            <span class="breadcrumb-separator" aria-hidden="true">›</span>
            <span property="name">はじめに</span>
            <meta property="position" content="2">
        </li>
    {% elsif page.url contains '/chapters/' %}
        <li property="itemListElement" typeof="ListItem">
            <span class="breadcrumb-separator" aria-hidden="true">›</span>
            <span property="name">章</span>
            <meta property="position" content="2">
        </li>
        
        <!-- Specific Chapter -->
        {% for chapter in site.data.navigation.chapters %}
            {% if page.url contains chapter.path %}
                <li property="itemListElement" typeof="ListItem">
                    <span class="breadcrumb-separator" aria-hidden="true">›</span>
                    <a property="item" typeof="WebPage" href="{{ site.baseurl }}{{ chapter.path }}">
                        <span property="name">{{ chapter.title }}</span>
                    </a>
                    <meta property="position" content="3">
                </li>
                {% break %}
            {% endif %}
        {% endfor %}
    {% elsif page.url contains '/appendices/' %}
        <li property="itemListElement" typeof="ListItem">
            <span class="breadcrumb-separator" aria-hidden="true">›</span>
            <span property="name">付録</span>
            <meta property="position" content="2">
        </li>
        
        <!-- Specific Appendix -->
        {% for appendix in site.data.navigation.appendices %}
            {% if page.url contains appendix.path %}
                <li property="itemListElement" typeof="ListItem">
                    <span class="breadcrumb-separator" aria-hidden="true">›</span>
                    <a property="item" typeof="WebPage" href="{{ site.baseurl }}{{ appendix.path }}">
                        <span property="name">{{ appendix.title }}</span>
                    </a>
                    <meta property="position" content="3">
                </li>
                {% break %}
            {% endif %}
        {% endfor %}
    {% endif %}
    
    <!-- Current Page (if different from section) -->
    {% unless page.url == '/' %}
        {% assign is_section_page = false %}
        {% if page.url contains '/chapters/' %}
            {% for chapter in site.data.navigation.chapters %}
                {% if page.url == chapter.path %}
                    {% assign is_section_page = true %}
                    {% break %}
                {% endif %}
            {% endfor %}
        {% elsif page.url contains '/appendices/' %}
            {% for appendix in site.data.navigation.appendices %}
                {% if page.url == appendix.path %}
                    {% assign is_section_page = true %}
                    {% break %}
                {% endif %}
            {% endfor %}
        {% elsif page.url contains '/introduction/' %}
            {% assign is_section_page = true %}
        {% endif %}
        
        {% unless is_section_page %}
        <li property="itemListElement" typeof="ListItem">
            <span class="breadcrumb-separator" aria-hidden="true">›</span>
            <span property="name" class="breadcrumb-current">{{ page.title | default: "現在のページ" }}</span>
            <meta property="position" content="4">
        </li>
        {% endunless %}
    {% endunless %}
</ol>

<style>
/* Breadcrumb Styles */
.breadcrumb-list {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    list-style: none;
    margin: 0 0 var(--space-6) 0;
    padding: var(--space-3) 0;
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    border-bottom: 1px solid var(--color-border-light);
}

.breadcrumb-list li {
    display: flex;
    align-items: center;
    margin: 0;
}

.breadcrumb-list a {
    color: var(--color-text-secondary);
    text-decoration: none;
    transition: color var(--transition-fast);
    display: flex;
    align-items: center;
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius-sm);
}

.breadcrumb-list a:hover {
    color: var(--color-primary);
    background-color: var(--color-bg-secondary);
}

.breadcrumb-home-icon {
    width: 14px;
    height: 14px;
    margin-right: var(--space-1);
    flex-shrink: 0;
}

.breadcrumb-separator {
    margin: 0 var(--space-2);
    color: var(--color-text-muted);
    user-select: none;
    font-weight: 400;
}

.breadcrumb-current {
    color: var(--color-text-primary);
    font-weight: 500;
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .breadcrumb-list {
        font-size: var(--font-size-xs);
        margin-bottom: var(--space-4);
        padding: var(--space-2) 0;
    }
    
    .breadcrumb-list a {
        padding: var(--space-1);
    }
    
    .breadcrumb-separator {
        margin: 0 var(--space-1);
    }
    
    .breadcrumb-current {
        max-width: 150px;
    }
}

@media (max-width: 480px) {
    /* Hide intermediate levels on very small screens */
    .breadcrumb-list li:nth-child(n+3):nth-last-child(n+3) {
        display: none;
    }
    
    .breadcrumb-list li:nth-child(n+3):nth-last-child(2) .breadcrumb-separator {
        content: '···';
    }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    .breadcrumb-list a {
        text-decoration: underline;
    }
    
    .breadcrumb-separator {
        font-weight: bold;
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .breadcrumb-list a {
        transition: none;
    }
}
</style>